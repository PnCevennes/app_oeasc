{%- macro choix(choix1, choix2, name, title, name_test, object=None) %}

  {%- set ns = namespace(choix1_checked = "") %}
  {%- set ns.choix2_checked = "" %}

  {%- if object[name] == true %}

    {%- set ns.choix1_checked = "checked" %}

  {%- endif %}

  {%- if object[name] == false %}

    {%- set ns.choix2_checked = "checked" %}

  {%- endif %}

  <div>

    <div id=name|upper class="form-question">

      <label class="label-question" for="{{ name }}">{{ title }} <span class="big-red">*</span></label>

      <div class=choice>

        <div class="custom-control custom-radio custom-control-inline">
          <input {{ns.choix1_checked}} id="{{ name }}-0" name="{{ name }}"" type="radio" value="T" required>
          <label class='label-choice' for="{{ name }}-0"> {{ choix1 }} </label>
        </div>

        <div class="custom-control custom-radio custom-control-inline">
          <input {{ns.choix2_checked}} id="{{ name }}-1" name="{{ name }}"" type="radio" value="F" required>
          <label class="labe-choice" for="{{ name }}-1"> {{ choix2 }} </label>
        </div>

      </div>
    </div>

  </div>

{%- endmacro %}


{%- macro radio_nomenclature(name, nomenclature, mnemonique, type, titre="", object=None, add="", required="required") %}

{%- if type == "checkbox" and required %}

  {%- set classes = "checkbox-group-required" %}

{%- endif %}

<div>

  <div id="{{ name | upper }}" class="{{classes}}">

    {%- if titre != "" %}

    <label for="{{ name }}">{{ titre }} 
    {%- if type == "checkbox" %}
    - <i small class="red">{{'(plusieurs réponses possibles)' if type == "checkbox" else ''}}</i>
    {%- endif %}

    <span class="big-red">{{ "*" if required!="" else "" }}</span></label>

    {%- endif %}

    {%- for elem in nomenclature[mnemonique]['values'] %}

      {%- set ns = namespace(checked="") %}

      {%- if type == "checkbox" %}

        {%- for d in object[name] %}
          {%- if elem.id_nomenclature|string == d["id_nomenclature"]|string %}
            {%- set ns.checked="checked" %}
          {%- endif %}
        {%- endfor %}

      {%- elif object[name] is defined %}

        {%- if elem.id_nomenclature|string == object[name]["id_nomenclature"]|string %}
          {%- set ns.checked = "checked" %}
        {%- endif %}

      {%- endif %}

    <div class="custom-control">

      <input id="{{ name }}{{ add|string }}-{{ elem.cd_nomenclature}}" name="{{ name }}{{ add|string }}" type="{{ type }}" value="{{ elem.id_nomenclature }}" {{ns.checked}} {{required}}>
      <label for="{{ name }}{{ add|string }}-{{ elem.cd_nomenclature }}">{{ elem.label_fr }}</label>

    </div>

    {%- endfor %}

  </div>

</div>

{%- endmacro %}


{%- macro input_text(name, titre="", object=None, required="required", disabled="", hidden="") %}
<div>

  <div id="{{ name | upper }}" class="form-question">
    <label for="{{ name }}">{{ titre }}<span class="big-red">{{ "*" if required!="" else "" }}</span></label>
    <input class="form-control" type="text" name="{{ name }}" id="{{name}}" value="{{ object[name] or '' }}" {{ required }} {{ disabled }} {{hidden}}>
  </div>

</div>
{%- endmacro %}


{%- macro input_tel(name, titre="", object=None, required="required", disabled="", hidden="") %}
<div>

  <div id="{{ name | upper }}" class="form-question">
    <label for="{{ name }}">{{ titre }}<span class="big-red">{{ "*" if required!="" else "" }}</span></label>
    <input class="form-control" type="tel" pattern="[0-9]{10}" name="{{ name }}" id="{{name}}" value="{{ object[name] or '' }}" {{ required }} {{ disabled }} {{hidden}}
    oninvalid="this.setCustomValidity('Entrer un numéro à 10 chiffres, ex 0123456789')"
    oninput="this.setCustomValidity('')">
  </div>

</div>
{%- endmacro %}


{%- macro input_email(name, titre="", object=None, required="required", disabled="", hidden="") %}
<div>

  <div id="{{ name | upper }}" class="form-question">
    <label for="{{ name }}">{{ titre }}<span class="big-red">{{ "*" if required!="" else "" }}</span></label><br>
    <input class="form-control" type="email" name="{{ name }}" id="{{name}}" value="{{ object[name] or '' }}" {{ required }} {{ disabled }}  {{hidden}}>
  </div>

</div>
{%- endmacro %}


{%- macro input_cp(name, titre="", object=None, required="required", disabled="", hidden="") %}
<div>

  <div id="{{ name | upper }}" class="form-question">
    <label for="{{ name }}">{{ titre }}<span class="big-red">{{ "*" if required!="" else "" }}</span></label><br>
    <input class="form-control" type="text" pattern="[0-9]{5}" name="{{ name }}" id="{{name}}" value="{{ object[name] or '' }}" {{ required }} {{ disabled }}  {{hidden}}
    oninvalid="this.setCustomValidity('Entrer un numéro à 5 chiffres, ex 54321')"
    oninput="this.setCustomValidity('')">
  </div>

</div>
{%- endmacro %}


{%- macro input_double(name, titre="", object=None, required="required", disabled="", hidden="") %}
<div>

  <div id="{{ name | upper }}">
    <label for="{{ name }}">{{ titre }}<span class="big-red">{{ "*" if required!="" }}</span></label><br>
    <input class="form-control" type="number" onchange="(function(el){el.value=parseFloat(el.value).toFixed(0);})(this)" name="{{ name }}" id="{{name}}" value="{{ object[name] or '' }}" {{ required }} {{ disabled }}  {{hidden}}>
  </div>

</div>
{%- endmacro %}
